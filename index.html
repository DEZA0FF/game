<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Telegram PvP Clicker (Bot)</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background: #0f0f0f;
  color: white;
  font-family: Arial;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.game { text-align: center; }
button {
  padding: 15px 30px;
  font-size: 20px;
  border-radius: 10px;
  border: none;
  margin: 10px;
}
</style>
</head>

<body>
<div class="game">
  <h2 id="mode">PvP —Ä–µ–∂–∏–º (—Å –±–æ—Ç–æ–º)</h2>
  <p>–¢—ã: <span id="score">0</span> | ü§ñ –ë–æ—Ç: <span id="botScore">0</span></p>
  <p>–í—Ä–µ–º—è: <span id="time">20</span></p>

  <button id="click">–ñ–ú–ò</button>
  <button id="start">üéÆ –ù–∞—á–∞—Ç—å –º–∞—Ç—á</button>
</div>

<script>
const tg = Telegram.WebApp;
tg.expand();

let score = 0;
let botScore = 0;
let time = 20;
let timer = null;
let playing = false;

const scoreEl = document.getElementById("score");
const botScoreEl = document.getElementById("botScore");
const timeEl = document.getElementById("time");

document.getElementById("start").onclick = () => {
  startGame();
};

document.getElementById("click").onclick = () => {
  if (!playing) return;
  score++;
  scoreEl.innerText = score;
  tg.HapticFeedback?.impactOccurred("light");
};

function startGame() {
  score = 0;
  botScore = 0;
  time = 20;
  playing = true;

  scoreEl.innerText = score;
  botScoreEl.innerText = botScore;
  timeEl.innerText = time;
  document.getElementById("mode").innerText = "‚öîÔ∏è –ú–∞—Ç—á —Å –±–æ—Ç–æ–º";

  timer = setInterval(() => {
    time--;
    timeEl.innerText = time;

    // –±–æ—Ç –∫–ª–∏–∫–∞–µ—Ç —Å–ª—É—á–∞–π–Ω–æ
    if (Math.random() < 0.7) {
      botScore += Math.floor(Math.random() * 2);
      botScoreEl.innerText = botScore;
    }

    if (time <= 0) endGame();
  }, 1000);
}

function endGame() {
  clearInterval(timer);
  playing = false;

  let result = "ü§ù –ù–∏—á—å—è";
  if (score > botScore) result = "üèÜ –¢—ã –ø–æ–±–µ–¥–∏–ª!";
  if (score < botScore) result = "‚ùå –¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª";

  document.getElementById("mode").innerText = result;

  tg.sendData(JSON.stringify({
    action: "bot_match_result",
    score: score,
    bot: botScore
  }));
}
</script>
</body>
</html>
